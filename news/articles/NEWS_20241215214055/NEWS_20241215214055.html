<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ung thư cổ tử cung: Nguyên nhân, Dấu hiệu &amp; Triệu chứng và Chẩn đoán - Tin Tức Y Khoa</title>
    
<script src="https://code.responsivevoice.org/responsivevoice.js?key=30xj8le1"></script>
        
  <script>
function waitForResponsiveVoice() {
    return new Promise((resolve, reject) => {
        let attempts = 0;
        const checkResponsiveVoice = setInterval(() => {
            attempts++;
            if (window.responsiveVoice && window.responsiveVoice.voiceSupport()) {
                clearInterval(checkResponsiveVoice);
                resolve();
            } else if (attempts > 50) { 
                clearInterval(checkResponsiveVoice);
                reject(new Error('ResponsiveVoice không load được'));
            }
        }, 100);
    });
}
    </script>


        <style>
         
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: Arial, sans-serif;
            line-height: 1.6;
            color: #333;
            background: #f5f5f5;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            flex: 1;
        }

         
        .article-category {
            display: inline-block;
            background: #0070c0;
            color: white;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.9em;
            margin-bottom: 15px;
        }

        .article-title {
            font-size: 2em;
            margin-bottom: 15px;
            line-height: 1.2;
            color: #333;
            padding: 10px;
        }

        .article-meta {
            color: #666;
            font-size: 0.9em;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 15px;
            flex-wrap: wrap;
        }

        .reading-time {
            display: inline-flex;
            align-items: center;
            gap: 5px;
            padding: 3px 8px;
            background: #f0f0f0;
            border-radius: 15px;
        }

         
        .article-content {
            background: white;
            padding: 30px;
            border-radius: 8px;
            margin-bottom: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .featured-image {
            width: 100%;
            height: auto;
            max-height: 500px;
            object-fit: cover;
            border-radius: 8px;
            margin-bottom: 20px;
        }

        .article-content p {
            margin-bottom: 15px;
            line-height: 1.8;
            padding: 10px;
            border-radius: 4px;
            transition: all 0.3s ease;
        }

        .article-content p.current,
        .article-title.current {
            background: #f0f9ff;
            border-left: 3px solid #0070c0;
            padding-left: 15px;
        }

         
        .speech-controls {
            margin: 20px 0;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 8px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }

        .speech-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 15px;
        }

        .speech-title {
            font-size: 1.1em;
            font-weight: bold;
            color: #333;
        }

        .controls-container {
            display: flex;
            align-items: center;
            gap: 20px;
            flex-wrap: wrap;
        }

        .control-button {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 10px 20px;
            background: #0070c0;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s ease;
        }

        .control-button:hover {
            opacity: 0.9;
            transform: translateY(-1px);
        }

        .control-button:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
        }

        .speed-control {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        select {
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            background: white;
            min-width: 120px;
        }

        .progress-container {
            margin-top: 15px;
            background: #e9ecef;
            height: 4px;
            border-radius: 2px;
            overflow: hidden;
        }

        .progress-bar {
            height: 100%;
            background: #0070c0;
            width: 0;
            transition: width 0.3s;
        }

        .status {
            padding: 10px 15px;
            margin: 10px 0;
            border-radius: 4px;
            display: none;
        }

        .status.active {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .status.reading {
            background: #e3f2fd;
            color: #0070c0;
            border-left: 4px solid #0070c0;
        }

        .status.paused {
            background: #fff3e0;
            color: #ef6c00;
            border-left: 4px solid #ef6c00;
        }

        .status.error {
            background: #ffebee;
            color: #c62828;
            border-left: 4px solid #c62828;
        }

         
        .related-section {
            margin-top: 40px;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .related-title {
            font-size: 1.5em;
            margin-bottom: 20px;
            color: #333;
        }

        .related-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
        }

        .related-article {
            background: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            transition: transform 0.3s;
            height: 100%;
            display: flex;
            flex-direction: column;
        }

        .related-article:hover {
            transform: translateY(-3px);
        }

        .related-article img {
            width: 100%;
            height: 180px;
            object-fit: cover;
        }

        .related-article h3 {
            padding: 15px;
            margin: 0;
            flex: 1;
        }

        .related-article a {
            color: #333;
            text-decoration: none;
        }

        .related-article a:hover {
            color: #0070c0;
        }

        .related-article .date {
            display: block;
            padding: 0 15px 15px;
            color: #666;
            font-size: 0.9em;
        }

         
        .share-section {
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px solid #eee;
        }

        .share-buttons {
            display: flex;
            gap: 10px;
        }

        .share-button {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 8px 16px;
            border: none;
            border-radius: 4px;
            color: white;
            cursor: pointer;
            font-size: 14px;
            transition: opacity 0.3s;
        }

        .share-button:hover {
            opacity: 0.9;
        }

        .share-button.facebook {
            background: #1877f2;
        }

        .share-button.twitter {
            background: #1da1f2;
        }

         
        @media (max-width: 768px) {
            .container {
                padding: 15px;
            }

            .article-title {
                font-size: 1.8em;
            }

            .article-meta {
                flex-direction: column;
                align-items: flex-start;
            }

            .controls-container {
                flex-direction: column;
                align-items: stretch;
            }

            .related-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <span class="article-category">Sản Phụ Khoa</span>
        
        <h1 class="article-title">Ung thư cổ tử cung: Nguyên nhân, Dấu hiệu &amp; Triệu chứng và Chẩn đoán</h1>
        
        <div class="article-meta">
            <span>Đăng ngày 15/12/2024</span>
            <span class="reading-time">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="12" cy="12" r="10"></circle>
                    <polyline points="12 6 12 12 16 14"></polyline>
                </svg>
                6 phút đọc
            </span>
        </div>

        <img src="https://www.saintjohnscancer.org/gynecology/wp-content/uploads/sites/8/2024/08/HPV-Human-Papillomavirus-Saint-Johns-Cancer-Institute.png" alt="Ung thư cổ tử cung: Nguyên nhân, Dấu hiệu &amp; Triệu chứng và Chẩn đoán" class="featured-image">

        <div class="article-content">
<div class="speech-controls">
    <div class="speech-header">
        <span class="speech-title">Nghe bài viết</span>
    </div>
    
    <div class="controls-container">
        
        <button type="button" id="mp3Button" class="control-button" onclick="toggleMP3()">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                <path d="M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3z"/>
                <path d="M19 10v2a7 7 0 0 1-14 0v-2"/>
                <line x1="12" y1="19" x2="12" y2="23"/>
                <line x1="8" y1="23" x2="16" y2="23"/>
            </svg>
            <span>Audio đã thu</span>
        </button>

        
        <button type="button" id="playButton" class="control-button" onclick="toggleSpeech()">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                <polygon points="5 3 19 12 5 21 5 3"></polygon>
            </svg>
            <span>Đọc bài viết</span>
        </button>
        
        
        <div id="ttsControls" class="speed-control">
            <select id="voiceSelect" onchange="handleVoiceChange()">
                <option value="Vietnamese Female">Giọng Nữ</option>
                <option value="Vietnamese Male">Giọng Nam</option>
            </select>
            <select id="rateSelect" onchange="handleRateChange()">
                <option value="0.8">Chậm</option>
                <option value="1" selected>Bình thường</option>
                <option value="1.2">Nhanh</option>
            </select>
        </div>
    </div>

    
    <audio id="mp3Player" controls style="width: 100%; margin-top: 10px; display: none;">
        <source id="mp3Source" type="audio/mpeg">
        Trình duyệt không hỗ trợ phát audio.
    </audio>

    <div class="progress-container">
        <div id="progress" class="progress-bar"></div>
    </div>

    <div id="status" class="status">
        <span id="statusText"></span>
    </div>
</div>

            <h2>Nguyên nhân gây ung thư cổ tử cung</h2><p>Có thể thực hiện sàng lọc ung thư tiền cổ tử cung hoặc ung thư cổ tử cung bằng xét nghiệm PAP lâm sàng.</p><p>Cổ tử cung là phần thấp nhất của tử cung, nối âm đạo và tử cung. Ung thư cổ tử cung chủ yếu được tìm thấy ở phụ nữ hoạt động tình dục, thường là do HPV hoặc Human Papillomavirus. Tiền ung thư cổ tử cung hoặc ung thư có thể được phát hiện bằng cách sàng lọc PAP và điều trị bằng phẫu thuật, hóa trị hoặc xạ trị.</p><p>Ung thư cổ tử cung chủ yếu là kết quả của tình trạng nhiễm trùng dai dẳng với các loại vi-rút u nhú ở người (HPV) có nguy cơ cao. Loại vi-rút này lây truyền qua đường tình dục và có thể gây ra những thay đổi trong các tế bào cổ tử cung, dẫn đến ung thư theo thời gian. Các yếu tố nguy cơ khác bao gồm hút thuốc, hệ thống miễn dịch suy yếu, sử dụng thuốc tránh thai đường uống trong thời gian dài và mang thai đủ tháng nhiều lần.</p><p>Việc sàng lọc thường xuyên thông qua xét nghiệm Pap và HPV có thể phát hiện những thay đổi tiền ung thư ở tế bào cổ tử cung, cho phép can thiệp sớm và ngăn ngừa sự phát triển của ung thư. Điều cần thiết là phải tuân theo các hướng dẫn sàng lọc được khuyến nghị để xác định sớm bất kỳ vấn đề tiềm ẩn nào. Nếu bạn gặp các triệu chứng hoặc có nguy cơ, hãy tham khảo ý kiến ​​bác sĩ chăm sóc sức khỏe của bạn để có các biện pháp sàng lọc và phòng ngừa phù hợp.</p><h2>Dấu hiệu và triệu chứng của ung thư cổ tử cung</h2><p><img src="https://www.saintjohnscancer.org/gynecology/wp-content/uploads/sites/8/2024/08/Patient-consultation-Cervical-Cancer-Saint-Johns-Health-Center.jpg" alt="Tư vấn bệnh nhân - Ung thư cổ tử cung - Trung tâm y tế Saint John" height="auto" width="100%">Mặc dù ung thư cổ tử cung có thể không biểu hiện triệu chứng, một hoặc nhiều tình trạng kết hợp có thể là lý do để bạn cần tìm kiếm sự chăm sóc ngay lập tức.</p><p>Giai đoạn đầu của ung thư cổ tử cung thường không biểu hiện dấu hiệu hoặc triệu chứng, vì vậy, điều quan trọng là phải khám phụ khoa thường xuyên và sàng lọc bằng xét nghiệm PAP và xét nghiệm HPV.</p><ul><li>Chảy máu sau khi giao hợp</li><li>Đau vùng chậu</li><li>Đau khi quan hệ tình dục</li><li>Khí hư bất thường, chảy máu hoặc có mùi ở âm đạo</li></ul><h2>Chẩn đoán ung thư cổ tử cung</h2><p>Chẩn đoán sớm lý tưởng có nghĩa là tìm thấy tiền ung thư cổ tử cung trên xét nghiệm phết tế bào cổ tử cung (PAP). Soi cổ tử cung cũng có thể được thực hiện trong đó bác sĩ sẽ nhìn vào cổ tử cung bằng kính hiển vi đặc biệt có thể phát hiện bất kỳ bất thường nào về thị giác. Sinh thiết cũng có thể được thực hiện ở vùng có vẻ bất thường để xác định xem có ung thư hay không.</p><h3>Các giai đoạn ung thư cổ tử cung</h3><p>Giai đoạn ung thư cổ tử cung được xác định tùy thuộc vào vị trí ung thư và liệu ung thư đã di căn sang các bộ phận khác của cơ thể hay chưa.</p><p><img src="https://www.saintjohnscancer.org/gynecology/wp-content/uploads/sites/8/2024/08/Cervical-Cancer-Stages-Saint-Johns-Cancer-Institute.jpg" alt="Các giai đoạn ung thư cổ tử cung - Viện ung thư Saint John" height="619" width="1195">Nếu không được điều trị, ung thư cổ tử cung có thể tiến triển và lan sang các bộ phận khác của cơ thể.</p><p>&nbsp;</p><p><strong style="color: rgb(10, 48, 57);">Giai đoạn I</strong>&nbsp;: Ung thư đã lan từ niêm mạc cổ tử cung vào mô sâu hơn nhưng vẫn chỉ được tìm thấy trong tử cung. Nó chưa lan đến hạch bạch huyết hoặc các bộ phận khác của cơ thể.</p><p><strong style="color: rgb(10, 48, 57);">Giai đoạn II</strong>&nbsp;: Ung thư đã lan ra ngoài cổ tử cung đến các khu vực lân cận, chẳng hạn như âm đạo hoặc mô gần cổ tử cung, nhưng vẫn nằm bên trong vùng chậu. Ung thư chưa lan đến các hạch bạch huyết hoặc các bộ phận khác của cơ thể.</p><p><strong style="color: rgb(10, 48, 57);">Giai đoạn III</strong>&nbsp;: Khối u đã lan đến thành chậu, và/hoặc liên quan đến phần ba dưới của âm đạo, và/hoặc gây sưng thận, được gọi là thận ứ nước, hoặc ngăn thận hoạt động. Không có hạch bạch huyết nào bị ảnh hưởng và không có sự lan rộng xa.</p><p><strong style="color: rgb(10, 48, 57);">Giai đoạn IVA</strong>&nbsp;: Ung thư đã di căn đến bàng quang hoặc trực tràng và có thể hoặc không di căn đến các hạch bạch huyết, nhưng chưa di căn đến các bộ phận khác của cơ thể.</p><p><strong style="color: rgb(10, 48, 57);">Giai đoạn IVB</strong>&nbsp;: Ung thư đã di căn đến các bộ phận khác của cơ thể.</p><p><strong style="color: rgb(10, 48, 57);">Tái phát</strong>&nbsp;: Ung thư tái phát là ung thư tái phát sau khi điều trị. Nếu ung thư tái phát, sẽ có một đợt xét nghiệm khác để tìm hiểu về mức độ tái phát. Các xét nghiệm và quét này thường tương tự như những xét nghiệm và quét được thực hiện tại thời điểm chẩn đoán ban đầu.</p><h2>Các yếu tố nguy cơ của ung thư cổ tử cung</h2><ul><li>HPV: Human Papillomavirus là nguyên nhân phổ biến nhất gây ra ung thư cổ tử cung. Tiêm vắc-xin phòng ngừa HPV đã làm giảm đáng kể tỷ lệ mắc ung thư cổ tử cung.</li><li>Quan hệ tình dục ở độ tuổi dưới 16: Phụ nữ bắt đầu hoạt động tình dục ở độ tuổi trẻ hơn thường có nhiều khả năng có nhiều bạn tình hơn trong suốt cuộc đời.</li><li>Quan hệ tình dục với nhiều người: Làm tăng tỷ lệ lây truyền HPV.</li><li>Hút thuốc: Các hóa chất có trong thuốc lá làm thay đổi các tế bào cổ tử cung, từ đó có thể dẫn đến ung thư.</li></ul><h2>Điều trị ung thư cổ tử cung</h2><p>Điều trị thường bao gồm phẫu thuật, hóa trị, liệu pháp nhắm mục tiêu sinh học hoặc xạ trị, hoặc kết hợp các phương pháp này tùy thuộc vào giai đoạn. Can thiệp phẫu thuật tại Viện Ung thư Saint John sử dụng công nghệ hỗ trợ bằng robot xâm lấn tối thiểu tiên tiến. Phẫu thuật bảo tồn khả năng sinh sản cũng có sẵn.</p><h3>Theo dõi</h3><p>Theo dõi bao gồm các lần khám lại và xét nghiệm PAP để phát hiện tái phát. Đôi khi cũng nên chụp ảnh. Chúng tôi cung cấp lời khuyên giúp bạn giảm nguy cơ tái phát bằng cách lựa chọn dinh dưỡng và lối sống.</p>
            <div class="share-section">
                <div class="share-buttons">
                    <button onclick="shareOnFacebook()" class="share-button facebook">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z"></path>
                        </svg>
                        Chia sẻ Facebook
                    </button>
                    <button onclick="shareOnTwitter()" class="share-button twitter">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M23 3a10.9 10.9 0 0 1-3.14 1.53 4.48 4.48 0 0 0-7.86 3v1A10.66 10.66 0 0 1 3 4s-4 9 5 13a11.64 11.64 0 0 1-7 2c9 5 20 0 20-11.5a4.5 4.5 0 0 0-.08-.83A7.72 7.72 0 0 0 23 3z"></path>
                        </svg>
                        Chia sẻ Twitter
                    </button>
                </div>
            </div>
        </div>

        <div class="related-section">
            <h2 class="related-title">Bài viết liên quan</h2>
            <div class="related-grid">
                
      <div class="related-article">
        <img src="https://raw.githubusercontent.com/fmcclinic/Medical_News/refs/heads/main/news/image/A%20woman%20with%20a%20visible%20pregnancy.jpg" alt="Dinh dưỡng trong thai kỳ - Ăn gì để mẹ khỏe con thông minh?">
        <h3>
          <a href="../../articles/NEWS_20241221144428/NEWS_20241221144428.html">Dinh dưỡng trong thai kỳ - Ăn gì để mẹ khỏe con thông minh?</a>
        </h3>
        <span class="date">21/12/2024</span>
      </div>
    
      <div class="related-article">
        <img src="https://raw.githubusercontent.com/fmcclinic/Medical_News/refs/heads/main/news/image/Normal%20and%20Abnormal%20Pregnancy%20Signs%20%20When%20to%20See%20a%20Doctor.jpg" alt="Những dấu hiệu thai kỳ bình thường và bất thường - Khi nào cần đến bác sĩ?">
        <h3>
          <a href="../../articles/NEWS_20241221131504/NEWS_20241221131504.html">Những dấu hiệu thai kỳ bình thường và bất thường - Khi nào cần đến bác sĩ?</a>
        </h3>
        <span class="date">21/12/2024</span>
      </div>
    
      <div class="related-article">
        <img src="https://www.tsmh.org.tw/sites/nursing_department/images/gyn/gyn_p12_2.png" alt="Chăm sóc hậu phẫu cho phẫu thuật phụ khoa">
        <h3>
          <a href="../../articles/NEWS_20241221002552/NEWS_20241221002552.html">Chăm sóc hậu phẫu cho phẫu thuật phụ khoa</a>
        </h3>
        <span class="date">21/12/2024</span>
      </div>
                </div>
        </div>
    </div>

<script>

const TTS_CONFIG = {
   VOICE_OPTIONS: {
       'Vietnamese Female': {
           name: 'Vietnamese Female',
           lang: 'vi-VN',
           rate: 1,
           pitch: 1.1,
           volume: 1
       },
       'Vietnamese Male': {
           name: 'Vietnamese Male',
           lang: 'vi-VN',
           rate: 1,
           pitch: 0.9,
           volume: 1
       }
   },
   PAUSE_BETWEEN: 500 
};





document.addEventListener('DOMContentLoaded', async function() {
    try {
        
        await waitForResponsiveVoice();
        console.log('ResponsiveVoice đã load và sẵn sàng');

        
        initTTS();
        checkForMP3();

    } catch (error) {
        console.error('Không thể khởi tạo ResponsiveVoice:', error);
    }
});


function initTTS() {
    console.log('Đang khởi tạo TTS');
    try {
        if (!window.responsiveVoice) {
            throw new Error('ResponsiveVoice chưa load');
        }

        if (!window.responsiveVoice.voiceSupport()) {
            throw new Error('Trình duyệt không hỗ trợ TTS');
        }

        setupElements();
        loadContentToRead();
        setupEventListeners();
        
        const playButton = document.getElementById('playButton');
        if (playButton) {
            playButton.disabled = false;
        }
        
        ttsInitialized = true;
        console.log('TTS đã khởi tạo thành công');
        updateStatus('Sẵn sàng đọc');

    } catch (error) {
        console.error('Lỗi khởi tạo TTS:', error);
        showError(error.message);
    }
}


function showError(message) {
    console.error(message);
    const statusText = document.getElementById('statusText');
    const status = document.getElementById('status');
    if (statusText && status) {
        statusText.textContent = message;
        status.className = 'status active error';
    }
}


function checkForMP3() {
   const pathParts = window.location.pathname.split('/');
   const newsId = pathParts[pathParts.length - 1].replace('.html', '');
   const mp3Path = `${newsId}.mp3`;
   
   const audio = document.createElement('audio');
   audio.addEventListener('canplaythrough', function() {
       setupMP3Player(mp3Path);
   });

   audio.addEventListener('error', function() {
       console.log('Không tìm thấy file MP3');
       document.getElementById('mp3Button').disabled = true;
   });

   audio.src = mp3Path;
   audio.load();
}


function setupMP3Player(mp3Path) {
   const mp3Player = document.getElementById('mp3Player');
   document.getElementById('mp3Source').src = mp3Path;
   mp3Player.load();

   
   const mp3Button = document.getElementById('mp3Button');
   mp3Button.disabled = false;
   mp3Button.onclick = toggleMP3;

   
   mp3Player.addEventListener('ended', function() {
       isMP3Playing = false;
       resetMP3Button();
   });
}


function toggleMP3() {
   if (isPlaying) {
       stopReading(); 
   }

   const mp3Player = document.getElementById('mp3Player');
   const mp3Button = document.getElementById('mp3Button');

   if (!isMP3Playing) {
       mp3Player.style.display = 'block';
       mp3Player.play();
       isMP3Playing = true;
       mp3Button.innerHTML = `
           <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor">
               <rect x="6" y="4" width="4" height="16"></rect>
               <rect x="14" y="4" width="4" height="16"></rect>
           </svg>
           <span>Tạm dừng</span>`;
   } else {
       mp3Player.pause();
       isMP3Playing = false;
       resetMP3Button();
   }
}


function resetMP3Button() {
   const mp3Button = document.getElementById('mp3Button');
   mp3Button.innerHTML = `
       <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor">
           <path d="M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3z"/>
           <path d="M19 10v2a7 7 0 0 1-14 0v-2"/>
           <line x1="12" y1="19" x2="12" y2="23"/>
           <line x1="8" y1="23" x2="16" y2="23"/>
       </svg>
       <span>Audio đã thu</span>`;
}




function setupElements() {
   const elements = ['playButton', 'voiceSelect', 'rateSelect', 'status', 'progress'];
   elements.forEach(id => {
       if (!document.getElementById(id)) {
           throw new Error(`Thiếu element: ${id}`);
       }
   });
}


function loadContentToRead() {
    const title = document.querySelector('.article-title');
    const paragraphElements = document.querySelectorAll('.article-content p');

    console.log('Title element:', title);
    console.log('Paragraph elements:', paragraphElements);

    paragraphs = [];

    
    if (title) {
        paragraphs.push({
            element: title,
            text: title.textContent.trim()
        });
    }

    
    const content = document.querySelector('.article-content');
    if (content) {
        
        const textElements = content.querySelectorAll('p, div > p, ul > li, ol > li');
        textElements.forEach((element) => {
            const text = element.textContent.trim();
            if (text.length > 0) {
                paragraphs.push({
                    element: element,
                    text: text
                });
            }
        });
    }

    console.log('Total paragraphs loaded:', paragraphs.length);
    console.log('Paragraphs content:', paragraphs.map(p => p.text));
}





function startReading() {
   isPlaying = true;
   currentParagraphIndex = 0;
   updateUI('reading');
   readNextParagraph();
}




function highlightParagraph(index) {
   if (paragraphs[index]) {
       paragraphs[index].element.classList.add('current');
       scrollToParagraph(paragraphs[index].element);
   }
}


function unhighlightParagraph(index) {
   if (paragraphs[index]) {
       paragraphs[index].element.classList.remove('current');
   }
}


function unhighlightAll() {
   paragraphs.forEach(p => p.element.classList.remove('current'));
}


function scrollToParagraph(element) {
   element.scrollIntoView({
       behavior: 'smooth',
       block: 'center'
   });
}


function updateUI(state) {
   const button = document.getElementById('playButton');
   if (button) {
       button.innerHTML = isPlaying ? 
           `<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor">
               <rect x="6" y="4" width="4" height="16"></rect>
               <rect x="14" y="4" width="4" height="16"></rect>
           </svg>
           <span>Tạm dừng</span>` :
           `<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor">
               <polygon points="5 3 19 12 5 21 5 3"></polygon>
           </svg>
           <span>Đọc bài viết</span>`;
   }
   updateStatus(state);
}

// Update status message
function updateStatus(state) {
   const status = document.getElementById('status');
   const statusText = document.getElementById('statusText');
   if (status && statusText) {
       status.className = 'status active ' + state;
       statusText.textContent = typeof state === 'string' ? state : 
           state === 'reading' ? 'Đang đọc...' :
           state === 'paused' ? 'Đã tạm dừng' :
           state === 'finished' ? 'Đã đọc xong' : '';
   }
}


function updateProgress(percent) {
   const progress = document.getElementById('progress');
   if (progress) {
       progress.style.width = percent + '%';
   }
}


function handleVoiceChange() {
   if (isPlaying) {
       restartReading();
   }
}


function handleRateChange() {
   if (isPlaying) {
       restartReading();
   }
}


function restartReading() {
   stopReading();
   startReading();
}


function showError(message) {
   console.error(message);
   updateStatus('error');
   const statusText = document.getElementById('statusText');
   if (statusText) {
       statusText.textContent = message;
   }
}













function toggleMP3() {
    console.log('toggleMP3 called');
    if (isPlaying) {
        stopReading(); 
    }

    const mp3Player = document.getElementById('mp3Player');
    const mp3Button = document.getElementById('mp3Button');

    
    console.log('mp3Player:', mp3Player);
    console.log('mp3Button:', mp3Button);

    if (!isMP3Playing) {
        mp3Player.style.display = 'block';
        mp3Player.play();
        isMP3Playing = true;
        mp3Button.innerHTML = `...`; 
    } else {
        mp3Player.pause();
        isMP3Playing = false;
        resetMP3Button();
    }
}


function setupMP3Player(mp3Path) {
    console.log('Setting up MP3 player with path:', mp3Path);
    
    const mp3Player = document.getElementById('mp3Player');
    const mp3Button = document.getElementById('mp3Button');
    
    if (!mp3Player || !mp3Button) {
        console.error('Missing MP3 elements');
        return;
    }

    
    document.getElementById('mp3Source').src = mp3Path;
    mp3Player.load();

    
    mp3Button.addEventListener('click', function(e) {
        e.preventDefault();
        toggleMP3();
    });

    
    mp3Button.disabled = false;

    console.log('MP3 player setup complete');
}


function setupEventListeners() {
    console.log('Setting up event listeners');
    
    const playButton = document.getElementById('playButton');
    const voiceSelect = document.getElementById('voiceSelect');
    const rateSelect = document.getElementById('rateSelect');

    if (playButton) {
        playButton.addEventListener('click', function(e) {
            e.preventDefault();
            console.log('TTS button clicked');
            toggleSpeech();
        });
    }

    if (voiceSelect) {
        voiceSelect.addEventListener('change', handleVoiceChange);
    }

    if (rateSelect) {
        rateSelect.addEventListener('change', handleRateChange);
    }

    console.log('Event listeners setup complete');
}


function toggleSpeech() {
    console.log('toggleSpeech called, ttsInitialized:', ttsInitialized);
    console.log('isPlaying:', isPlaying);

    if (!ttsInitialized) {
        console.error('TTS not initialized');
        showError('TTS chưa sẵn sàng');
        return;
    }

    if (isMP3Playing) {
        const mp3Player = document.getElementById('mp3Player');
        mp3Player.pause();
        isMP3Playing = false;
        resetMP3Button();
    }

    if (!isPlaying) {
        startReading();
    } else {
        stopReading();
    }
}









function toggleSpeech() {
    console.log('toggleSpeech called, ttsInitialized:', ttsInitialized);
    console.log('isPlaying:', isPlaying);

    
    if (!ttsInitialized && !initTTS()) {
        showError('TTS chưa sẵn sàng, vui lòng thử lại');
        return;
    }

    
    if (isMP3Playing) {
        const mp3Player = document.getElementById('mp3Player');
        mp3Player.pause();
        isMP3Playing = false;
        resetMP3Button();
    }

    if (!isPlaying) {
        startReading();
    } else {
        stopReading();
    }
}








function toggleSpeech() {
    console.log('toggleSpeech called, ttsInitialized:', ttsInitialized);
    console.log('isPlaying before toggle:', isPlaying);

    if (!ttsInitialized) {
        showError('TTS chưa sẵn sàng');
        return;
    }

    if (isMP3Playing) {
        const mp3Player = document.getElementById('mp3Player');
        mp3Player.pause();
        isMP3Playing = false;
        resetMP3Button();
    }

    isPlaying = !isPlaying; 
    console.log('isPlaying after toggle:', isPlaying);

    if (isPlaying) {
        startReading();
    } else {
        stopReading();
    }
}



function setupEventListeners() {
    console.log('Setting up event listeners');
    
    
    const playButton = document.getElementById('playButton');
    if (playButton) {
        playButton.removeEventListener('click', toggleSpeech); 
        playButton.addEventListener('click', function(e) {
            e.preventDefault();
            e.stopPropagation(); 
            console.log('TTS button clicked');
            
            if (!isPlaying) {
                isPlaying = true;
                startReading();
            } else {
                isPlaying = false;
                stopReading();
            }
        });
    }

    
    const voiceSelect = document.getElementById('voiceSelect');
    const rateSelect = document.getElementById('rateSelect');

    if (voiceSelect) {
        voiceSelect.addEventListener('change', handleVoiceChange);
    }

    if (rateSelect) {
        rateSelect.addEventListener('change', handleRateChange);
    }

    console.log('Event listeners setup complete');
}

function readNextParagraph() {
    console.log('Reading paragraph:', currentParagraphIndex + 1, 'of', paragraphs.length);
    console.log('isPlaying status:', isPlaying);

    if (currentParagraphIndex < paragraphs.length) {
        try {
            const voiceName = document.getElementById('voiceSelect').value;
            const rate = parseFloat(document.getElementById('rateSelect').value);

            console.log('Current text:', paragraphs[currentParagraphIndex].text);
            console.log('Voice:', voiceName, 'Rate:', rate);

            responsiveVoice.speak(
                paragraphs[currentParagraphIndex].text,
                voiceName,
                {
                    rate: rate,
                    onstart: () => {
                        console.log(`Bắt đầu đọc đoạn ${currentParagraphIndex + 1}/${paragraphs.length}`);
                        updateStatus(`Đang đọc đoạn ${currentParagraphIndex + 1}/${paragraphs.length}`);
                        highlightParagraph(currentParagraphIndex);
                        updateProgress(((currentParagraphIndex + 1) / paragraphs.length) * 100);
                    },
                    onend: () => {
                        console.log(`Kết thúc đọc đoạn ${currentParagraphIndex + 1}`);
                        unhighlightParagraph(currentParagraphIndex);
                        
                        
                        currentParagraphIndex++;
                        if (isPlaying && currentParagraphIndex < paragraphs.length) {
                            console.log('Proceeding to next paragraph');
                            readNextParagraph(); 
                        } else if (currentParagraphIndex >= paragraphs.length) {
                            console.log('Reached end of content');
                            finishReading();
                        }
                    }
                }
            );
        } catch (error) {
            console.error('Error in readNextParagraph:', error);
            stopReading();
        }
    } else {
        finishReading();
    }
}


function setupPlayButton() {
    const playButton = document.getElementById('playButton');
    if (playButton) {
        playButton.onclick = function(e) {
            e.preventDefault();
            console.log('Play button clicked');
            if (!isPlaying) {
                isPlaying = true;
                currentParagraphIndex = 0; 
                startReading();
            } else {
                isPlaying = false;
                stopReading();
            }
            updateUI(isPlaying ? 'reading' : 'paused');
        };
    }
}






let isPlaying = false;
let isMP3Playing = false;
let currentParagraphIndex = 0;
let paragraphs = [];
let ttsInitialized = false;



function stopReading() {
    console.log('Stopping reading');
    isPlaying = false;
    if (responsiveVoice) {
        responsiveVoice.cancel(); 
    }
    unhighlightAll();
    updateUI('paused');
}


function startReading() {
    console.log('Starting reading');
    isPlaying = true;
    currentParagraphIndex = 0;
    updateUI('reading');
    readNextParagraph();
}


function handlePlayButtonClick() {
    console.log('Play button clicked, current state:', isPlaying);
    if (!isPlaying) {
        startReading();
    } else {
        stopReading();
    }
}


function setupPlayButton() {
    const playButton = document.getElementById('playButton');
    if (playButton) {
        playButton.onclick = handlePlayButtonClick;
    }
}


function readNextParagraph() {
    console.log('Reading paragraph:', currentParagraphIndex + 1, 'of', paragraphs.length);
    console.log('isPlaying status:', isPlaying);

    if (!isPlaying) {
        console.log('Reading stopped');
        return;
    }

    if (currentParagraphIndex < paragraphs.length) {
        try {
            const voiceName = document.getElementById('voiceSelect').value;
            const rate = parseFloat(document.getElementById('rateSelect').value);

            console.log('Current text:', paragraphs[currentParagraphIndex].text);
            console.log('Voice:', voiceName, 'Rate:', rate);

            responsiveVoice.speak(
                paragraphs[currentParagraphIndex].text,
                voiceName,
                {
                    rate: rate,
                    onstart: () => {
                        console.log(`Bắt đầu đọc đoạn ${currentParagraphIndex + 1}/${paragraphs.length}`);
                        updateStatus(`Đang đọc đoạn ${currentParagraphIndex + 1}/${paragraphs.length}`);
                        highlightParagraph(currentParagraphIndex);
                        updateProgress(((currentParagraphIndex + 1) / paragraphs.length) * 100);
                    },
                    onend: () => {
                        console.log(`Kết thúc đọc đoạn ${currentParagraphIndex + 1}`);
                        unhighlightParagraph(currentParagraphIndex);
                        
                        if (isPlaying) {
                            currentParagraphIndex++;
                            if (currentParagraphIndex < paragraphs.length) {
                                console.log('Moving to next paragraph');
                                readNextParagraph();
                            } else {
                                console.log('Reached end of content');
                                finishReading();
                            }
                        }
                    }
                }
            );
        } catch (error) {
            console.error('Error in readNextParagraph:', error);
            stopReading();
        }
    } else {
        finishReading();
    }
}


function setupEventListeners() {
    console.log('Setting up event listeners');
    setupPlayButton();
    
    
    const voiceSelect = document.getElementById('voiceSelect');
    const rateSelect = document.getElementById('rateSelect');

    if (voiceSelect) {
        voiceSelect.onchange = handleVoiceChange;
    }

    if (rateSelect) {
        rateSelect.onchange = handleRateChange;
    }

    console.log('Event listeners setup complete');
}



















window.onload = function() {
   window.scrollTo(0, 0);
   updateParentHeight();
}


function updateParentHeight() {
   const height = document.documentElement.scrollHeight;
   window.parent.postMessage({ height: height }, '*');
}


new ResizeObserver(updateParentHeight).observe(document.body);


function shareOnFacebook() {
   const url = window.location.href;
   window.open('https://www.facebook.com/sharer/sharer.php?u=' + encodeURIComponent(url));
}

function shareOnTwitter() {
   const url = window.location.href;
   const title = document.title;
   window.open('https://twitter.com/intent/tweet?url=' + encodeURIComponent(url) + '&text=' + encodeURIComponent(title));
}
</script>
</body>
</html>