<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HPV và ung thư cổ tử cung: Những điều bạn cần biết - Tin Tức Y Khoa</title>

    <meta name="description" content="Virus papilloma ở người (HPV) là bệnh lây truyền qua đường tình dục phổ biến nhất ở Hoa Kỳ và có hơn 200 chủng loại virus này.Bốn mươi trong số đó ...">
    <meta name="keywords" content="Sản Phụ Khoa, y học, sức khỏe, tin tức y khoa">
    <meta name="author" content="Medical Team">

    <meta property="og:type" content="article" />
    <meta property="og:title" content="HPV và ung thư cổ tử cung: Những điều bạn cần biết" />
    <meta property="og:description" content="Virus papilloma ở người (HPV) là bệnh lây truyền qua đường tình dục phổ biến nhất ở Hoa Kỳ và có hơn 200 chủng loại virus này.Bốn mươi trong số đó ..." />
    <meta property="og:image" content="https://magazine.medlineplus.gov/images/uploads/main_images/caervicalcancer-hpv.jpg" />
    <meta property="og:site_name" content="Tin Tức Y Khoa" />
    <meta property="article:section" content="Sản Phụ Khoa" />
    <meta property="article:published_time" content="17/12/2024" />

    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="HPV và ung thư cổ tử cung: Những điều bạn cần biết">
    <meta name="twitter:description" content="Virus papilloma ở người (HPV) là bệnh lây truyền qua đường tình dục phổ biến nhất ở Hoa Kỳ và có hơn 200 chủng loại virus này.Bốn mươi trong số đó ...">
    <meta name="twitter:image" content="https://magazine.medlineplus.gov/images/uploads/main_images/caervicalcancer-hpv.jpg">
    <script src="https://code.responsivevoice.org/responsivevoice.js?key=30xj8le1"></script>
    
    <script>
    function waitForResponsiveVoice() {
        return new Promise((resolve, reject) => {
            let attempts = 0;
            const checkResponsiveVoice = setInterval(() => {
                attempts++;
                if (window.responsiveVoice && window.responsiveVoice.voiceSupport()) {
                    clearInterval(checkResponsiveVoice);
                    resolve();
                } else if (attempts > 50) { 
                    clearInterval(checkResponsiveVoice);
                    reject(new Error('ResponsiveVoice không load được'));
                }
            }, 100);
        });
    }
    </script>

    <style>
         
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: Arial, sans-serif;
            line-height: 1.6;
            color: #333;
            background: #f5f5f5;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            flex: 1;
        }

         
        .article-category {
            display: inline-block;
            background: #0070c0;
            color: white;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.9em;
            margin-bottom: 15px;
        }

        .article-title {
            font-size: 2em;
            margin-bottom: 15px;
            line-height: 1.2;
            color: #333;
            padding: 10px;
        }

        .article-meta {
            color: #666;
            font-size: 0.9em;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 15px;
            flex-wrap: wrap;
        }

        .reading-time {
            display: inline-flex;
            align-items: center;
            gap: 5px;
            padding: 3px 8px;
            background: #f0f0f0;
            border-radius: 15px;
        }

         
        .article-content {
            background: white;
            padding: 30px;
            border-radius: 8px;
            margin-bottom: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

         
        .article-content img {
            max-width: 100% !important;  
            height: auto !important;     
            display: block;              
            margin: 10px auto;           
            border-radius: 4px;          
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);  
        }

         
        .featured-image {
            display: block;
            width: auto;
            max-width: 100%;
            height: 500px;
            margin: 0 auto 20px auto;
            object-fit: contain;
            background-color: #f0f2f5;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        @media (max-width: 768px) {
            .featured-image {
                width: 100%;
                height: auto;
                max-height: 500px;
                object-fit: cover;
            }
        }

        .article-content p {
            margin-bottom: 15px;
            line-height: 1.8;
            padding: 10px;
            border-radius: 4px;
            transition: all 0.3s ease;
        }

        .article-content p.current,
        .article-title.current {
            background: #f0f9ff;
            border-left: 3px solid #0070c0;
            padding-left: 15px;
        }

         
        .speech-controls {
            margin: 20px 0;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 8px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }

        .speech-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 15px;
        }

        .speech-title {
            font-size: 1.1em;
            font-weight: bold;
            color: #333;
        }

        .controls-container {
            display: flex;
            align-items: center;
            gap: 20px;
            flex-wrap: wrap;
        }

        .control-button {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 10px 20px;
            background: #0070c0;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s ease;
        }

        .control-button:hover {
            opacity: 0.9;
            transform: translateY(-1px);
        }

        .control-button:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
        }

        .speed-control {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        select {
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            background: white;
            min-width: 120px;
        }

        .progress-container {
            margin-top: 15px;
            background: #e9ecef;
            height: 4px;
            border-radius: 2px;
            overflow: hidden;
        }

        .progress-bar {
            height: 100%;
            background: #0070c0;
            width: 0;
            transition: width 0.3s;
        }

        .status {
            padding: 10px 15px;
            margin: 10px 0;
            border-radius: 4px;
            display: none;
        }

        .status.active {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .status.reading {
            background: #e3f2fd;
            color: #0070c0;
            border-left: 4px solid #0070c0;
        }

        .status.paused {
            background: #fff3e0;
            color: #ef6c00;
            border-left: 4px solid #ef6c00;
        }

        .status.error {
            background: #ffebee;
            color: #c62828;
            border-left: 4px solid #c62828;
        }

         
        .related-section {
            margin-top: 40px;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .related-title {
            font-size: 1.5em;
            margin-bottom: 20px;
            color: #333;
        }

        .related-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
        }

        .related-article {
            background: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            transition: transform 0.3s;
            height: 100%;
            display: flex;
            flex-direction: column;
        }

        .related-article:hover {
            transform: translateY(-3px);
        }

        .related-article img {
            width: 100%;
            height: 180px;
            object-fit: cover;
        }

        .related-article h3 {
            padding: 15px;
            margin: 0;
            flex: 1;
        }

        .related-article a {
            color: #333;
            text-decoration: none;
        }

        .related-article a:hover {
            color: #0070c0;
        }

        .related-article .date {
            display: block;
            padding: 0 15px 15px;
            color: #666;
            font-size: 0.9em;
        }

         
        .share-section {
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px solid #eee;
        }

        .share-buttons {
            display: flex;
            gap: 10px;
        }

        .share-button {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 8px 16px;
            border: none;
            border-radius: 4px;
            color: white;
            cursor: pointer;
            font-size: 14px;
            transition: opacity 0.3s;
        }

        .share-button:hover {
            opacity: 0.9;
        }

        .share-button.facebook {
            background: #1877f2;
        }

        .share-button.twitter {
            background: #1da1f2;
        }

         
        @media (max-width: 768px) {
            .container {
                padding: 15px;
            }

            .article-title {
                font-size: 1.8em;
            }

            .article-meta {
                flex-direction: column;
                align-items: flex-start;
            }

            .controls-container {
                flex-direction: column;
                align-items: stretch;
            }

            .related-grid {
                grid-template-columns: 1fr;
            }
        }

         
        .article-content ul, 
        .article-content ol {
            padding-left: 40px !important;
            margin-bottom: 15px;
            list-style-type: disc !important;
        }

        .article-content li {
            display: list-item !important;
            list-style-type: disc !important;
        }

        .article-content ul ul,
        .article-content ol ol,
        .article-content ul ol,
        .article-content ol ul {
            list-style-type: circle !important;
        }
    </style>
</head>
<body>
    <div class="container">
        <span class="article-category">Sản Phụ Khoa</span>
        
        <h1 class="article-title">HPV và ung thư cổ tử cung: Những điều bạn cần biết</h1>
        
        <div class="article-meta">
            <span>Đăng ngày 17/12/2024</span>
            <span class="reading-time">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="12" cy="12" r="10"></circle>
                    <polyline points="12 6 12 12 16 14"></polyline>
                </svg>
                5 phút đọc
            </span>
        </div>

        <img src="https://magazine.medlineplus.gov/images/uploads/main_images/caervicalcancer-hpv.jpg" alt="HPV và ung thư cổ tử cung: Những điều bạn cần biết" class="featured-image">

        <div class="article-content">
            <div class="speech-controls">
                <div class="speech-header">
                    <span class="speech-title">Nghe bài viết</span>
                </div>
                
                <div class="controls-container">
                    <button id="mp3Button" class="control-button" onclick="toggleMP3()">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                            <path d="M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3z"/>
                            <path d="M19 10v2a7 7 0 0 1-14 0v-2"/>
                        </svg>
                        <span>Audio đã thu</span>
                    </button>

                    <button id="playButton" class="control-button">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                            <polygon points="5 3 19 12 5 21 5 3"></polygon>
                        </svg>
                        <span>Đọc bài viết</span>
                    </button>
                    
                    <div class="speed-control">
                        <select id="voiceSelect">
                            <option value="Vietnamese Female">Giọng Nữ</option>
                            <option value="Vietnamese Male">Giọng Nam</option>
                        </select>
                        <select id="rateSelect">
                            <option value="0.8">Chậm</option>
                            <option value="1" selected>Bình thường</option>
                            <option value="1.2">Nhanh</option>
                        </select>
                    </div>
                </div>

                <audio id="mp3Player" class="audio-player" controls style="width: 100%; margin-top: 10px; display: none;">
                    <source id="mp3Source" type="audio/mpeg">
                    Trình duyệt không hỗ trợ phát audio.
                </audio>

                <div class="progress-container">
                    <div id="progress" class="progress-bar"></div>
                </div>

                <div id="status" class="status">
                    <span id="statusText"></span>
                </div>
            </div>

            
        <style>
           .article-content ul, .article-content ol { list-style-type: disc !important; margin-left: 20px !important; }
           .article-content li { display: list-item !important; list-style-type: disc !important; }
        </style>
      <p>Virus papilloma ở người (HPV) là bệnh lây truyền qua đường tình dục phổ biến nhất ở Hoa Kỳ và có hơn 200 chủng loại virus này.</p><p>Bốn mươi trong số đó được gọi là HPV nguy cơ cao, có thể dẫn đến ung thư cổ tử cung ở phụ nữ. HPV nguy cơ thấp thường gây ra các triệu chứng không đe dọa đến tính mạng, chẳng hạn như mụn cóc sinh dục.</p><p>Điều quan trọng là phải biết rằng HPV nguy cơ cao tự nó không phải là ung thư. Tám trong số 10 phụ nữ sẽ mắc HPV nguy cơ cao vào một thời điểm nào đó trong cuộc đời, nhưng rất ít người trong số họ sẽ bị ung thư cổ tử cung.</p><p>May mắn thay, có một loại vắc-xin có thể bảo vệ mọi người khỏi một số chủng HPV có nguy cơ cao.</p><h3>Bạn bị nhiễm HPV như thế nào?</h3><p>Bạn có thể bị nhiễm HPV khi quan hệ tình dục qua đường âm đạo, hậu môn hoặc miệng với người bị nhiễm vi-rút. Bất kỳ ai hoạt động tình dục đều có thể bị nhiễm HPV, ngay cả khi bạn chỉ quan hệ tình dục với một người. HPV có thể lây truyền ngay cả khi người bị nhiễm không có triệu chứng.</p><h3>Ai có thể bị nhiễm HPV?</h3><p>Cả nam và nữ đều có thể bị HPV. Điều quan trọng cần biết là phụ nữ có thể được xét nghiệm HPV, nhưng nam giới thì không. Tuy nhiên, nam giới có thể tiêm vắc-xin HPV, giúp ngăn ngừa họ bị mụn cóc sinh dục và một số loại ung thư, bao gồm ung thư dương vật, hậu môn và cổ họng. Vắc-xin cũng giúp bảo vệ bạn tình của họ.</p><p>Trung tâm Kiểm soát và Phòng ngừa Dịch bệnh không khuyến nghị xét nghiệm thường quy cho nam giới về các loại ung thư này vì chúng ít phổ biến hơn nhiều. Tuy nhiên, nếu bạn nghĩ mình có thể bị HPV hoặc ung thư, hãy liên hệ với nhà cung cấp dịch vụ chăm sóc sức khỏe của bạn.</p><h3>Triệu chứng của HPV và ung thư cổ tử cung là gì?</h3><p>Mụn cóc sinh dục có thể là dấu hiệu của HPV ở nam và nữ. Tuy nhiên, nhiều chủng HPV, đặc biệt là những chủng gây ung thư, không có triệu chứng đáng chú ý. Những chủng này chỉ có thể được phát hiện bằng xét nghiệm Pap, xét nghiệm cổ tử cung của phụ nữ, phần dưới tử cung của cô ấy, để tìm bất kỳ thay đổi tế bào nào.</p><p>Các triệu chứng của ung thư cổ tử cung ở phụ nữ có thể xuất hiện nhiều năm sau khi nhiễm HPV. Chúng bao gồm:</p><ul><li>Chảy máu và ra máu giữa các kỳ kinh nguyệt</li><li>Chảy máu sau khi quan hệ tình dục qua đường âm đạo</li><li>Chảy máu sau mãn kinh</li><li>Chu kỳ kinh nguyệt nặng hơn bình thường</li><li>Chảy máu sau khi khám vùng chậu</li><li>Dịch tiết bất thường từ âm đạo</li><li>Đau khi quan hệ tình dục</li></ul><h3>HPV và ung thư cổ tử cung được điều trị như thế nào?</h3><blockquote>Cả nam giới và phụ nữ đều có thể bị nhiễm HPV, nhưng nam giới không thể xét nghiệm được.</blockquote><p>Không có cách chữa trị hoặc điều trị HPV, nhưng có cách điều trị các biến chứng mà nó có thể gây ra, chẳng hạn như mụn cóc sinh dục, tế bào gây ung thư và ung thư cổ tử cung.</p><p>Phương pháp điều trị ung thư cổ tử cung tùy thuộc vào mức độ tiến triển của bệnh, nhưng có thể bao gồm hóa trị, xạ trị và phẫu thuật.</p><p>Xét nghiệm Pap và HPV thường xuyên giúp bác sĩ biết bạn có bị HPV hay không và nếu có, hãy theo dõi. Phát hiện sớm thường ngăn ngừa ung thư cổ tử cung. Hãy hỏi bác sĩ chăm sóc sức khỏe của bạn về lịch trình sàng lọc tốt nhất cho bạn.</p><p><br></p><h3>Ai nên tiêm vắc-xin HPV?</h3><p>Vắc-xin HPV là một công cụ quan trọng để ngăn ngừa HPV và các biến chứng của nó, đặc biệt hiệu quả khi tiêm ở độ tuổi trẻ.</p><p>Cục Quản lý Thực phẩm và Dược phẩm khuyến cáo rằng hầu hết trẻ em nên tiêm vắc-xin HPV ở độ tuổi 11 hoặc 12. Lịch tiêm vắc-xin phụ thuộc vào độ tuổi của trẻ khi được tiêm vắc-xin lần đầu, nhưng trẻ em thường được tiêm hai liều.</p><p>Việc tiêm vắc-xin thường không được khuyến khích cho những người trên 26 tuổi. Tuy nhiên, một số người lớn từ 27 đến 45 tuổi chưa được tiêm vắc-xin có thể quyết định tiêm vắc-xin HPV sau khi trao đổi với nhà cung cấp dịch vụ chăm sóc sức khỏe của mình.&nbsp;</p><p><br></p><p><strong>Nguồn:</strong>&nbsp;&nbsp;MedlinePlus; Viện Ung thư Quốc gia; Trung tâm Kiểm soát và Phòng ngừa Dịch bệnh</p><p><strong>Nguồn hình ảnh:</strong>&nbsp;Donny Bliss, Thư viện Y khoa Quốc gia, Văn phòng Truyền thông và Liên lạc Công chúng</p><p>Ngày 16 tháng 4 năm 2020</p>
            <div class="share-section">
                <div class="share-buttons">
                    <button onclick="shareOnFacebook()" class="share-button facebook">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z"></path>
                        </svg>
                        Chia sẻ Facebook
                    </button>
                    <button onclick="shareOnTwitter()" class="share-button twitter">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M23 3a10.9 10.9 0 0 1-3.14 1.53 4.48 4.48 0 0 0-7.86 3v1A10.66 10.66 0 0 1 3 4s-4 9 5 13a11.64 11.64 0 0 1-7 2c9 5 20 0 20-11.5a4.5 4.5 0 0 0-.08-.83A7.72 7.72 0 0 0 23 3z"></path>
                        </svg>
                        Chia sẻ Twitter
                    </button>
                </div>
            </div>
        </div>

        <div class="related-section">
            <h2 class="related-title">Bài viết liên quan</h2>
            <div class="related-grid">
                
        <div class="related-article">
          <a href="../NEWS_20251026225706/NEWS_20251026225706.html"><img src="https://benhvienthucuc.vn/_next/image?url=https%3A%2F%2Fbenhvienthucuc.vn%2Fwp-content%2Fuploads%2F2016%2F12%2FNh%25E1%25BB%25AFng-b%25E1%25BB%2587nh-ph%25E1%25BB%25A5-khoa-b%25C3%25A0-b%25E1%25BA%25A7u-c%25C3%25B3-th%25E1%25BB%2583-m%25E1%25BA%25AFc.jpeg&amp;w=1080&amp;q=100" alt="Khám thai định kỳ"></a>
          <h3><a href="../NEWS_20251026225706/NEWS_20251026225706.html">Khám thai định kỳ</a></h3>
          <span class="date">26/10/2025</span>
        </div>
        <div class="related-article">
          <a href="../NEWS_20241228101505/NEWS_20241228101505.html"><img src="https://ilshospitals.com/blog/wp-content/uploads/2019/07/Common-Gynecological-Problems.png" alt="Các vấn đề phụ khoa thường gặp: Nguyên nhân, triệu chứng và phòng ngừa."></a>
          <h3><a href="../NEWS_20241228101505/NEWS_20241228101505.html">Các vấn đề phụ khoa thường gặp: Nguyên nhân, triệu chứng và phòng ngừa.</a></h3>
          <span class="date">28/12/2024</span>
        </div>
        <div class="related-article">
          <a href="../NEWS_20241225192105/NEWS_20241225192105.html"><img src="https://github.com/fmcclinic/Medical_News/blob/main/news/image/C%C3%A1c%20b%E1%BB%87nh%20ph%E1%BB%A5%20khoa%20th%C6%B0%E1%BB%9Dng%20g%E1%BA%B7p%20v%C3%A0%20c%C3%A1ch%20ph%C3%B2ng%20ng%E1%BB%ABa.jpg?raw=true" alt="Các bệnh phụ khoa thường gặp và cách phòng ngừa."></a>
          <h3><a href="../NEWS_20241225192105/NEWS_20241225192105.html">Các bệnh phụ khoa thường gặp và cách phòng ngừa.</a></h3>
          <span class="date">25/12/2024</span>
        </div>            </div>
        </div>
    </div>

<script>

let currentMP3File = null;
let audioPreviewUrl = null;
let isPlaying = false;
let isTTSPlaying = false;
let isMP3Playing = false;
let ttsInitialized = false;
let currentParagraphIndex = 0;
let paragraphs = [];


const TTS_CONFIG = {
    VOICE_OPTIONS: {
        'Vietnamese Female': { name: 'Vietnamese Female', lang: 'vi-VN', rate: 1, pitch: 1.1, volume: 1 },
        'Vietnamese Male': { name: 'Vietnamese Male', lang: 'vi-VN', rate: 1, pitch: 0.9, volume: 1 }
    },
    PAUSE_BETWEEN: 500 
};


document.addEventListener('DOMContentLoaded', function() {
    if (typeof responsiveVoice !== 'undefined') {
        responsiveVoice.OnVoiceReady = function() {
            console.log('ResponsiveVoice sẵn sàng');
            initTTS();
            setupMP3EventListeners();
        };
    }
    window.scrollTo(0, 0);
    updateParentHeight();
});


new ResizeObserver(updateParentHeight).observe(document.body);


function initTTS() {
    console.log('Đang khởi tạo TTS');
    try {
        if (!responsiveVoice.voiceSupport()) {
            throw new Error('Trình duyệt không hỗ trợ TTS');
        }
        setupElements();
        loadContentToRead();
        setupEventListeners();
        
        const playButton = document.getElementById('playButton');
        if (playButton) playButton.disabled = false;
        
        ttsInitialized = true;
        updateStatus('Sẵn sàng đọc');
    } catch (error) {
        console.error('Lỗi khởi tạo TTS:', error);
        showError(error.message);
    }
}


function setupElements() {
    const elements = ['playButton', 'voiceSelect', 'rateSelect', 'status', 'progress'];
    elements.forEach(id => {
        if (!document.getElementById(id)) throw new Error(`Thiếu element: ${id}`);
    });
}


function loadContentToRead() {
    const title = document.querySelector('.article-title');
    const contentElements = document.querySelectorAll('.article-content p, .article-content div > p, .article-content ul > li, .article-content ol > li');
    
    paragraphs = [];
    if (title) paragraphs.push({ element: title, text: title.textContent.trim() });

    contentElements.forEach(element => {
        const text = element.textContent.trim();
        if (text.length > 0) paragraphs.push({ element: element, text: text });
    });
}


function setupEventListeners() {
    const playButton = document.getElementById('playButton');
    const voiceSelect = document.getElementById('voiceSelect');
    const rateSelect = document.getElementById('rateSelect');
    const mp3Button = document.getElementById('mp3Button');

    if (playButton) {
        playButton.addEventListener('click', function(e) {
            e.preventDefault();
            toggleSpeech();
        });
    }
    if (voiceSelect) voiceSelect.addEventListener('change', handleVoiceChange);
    if (rateSelect) rateSelect.addEventListener('change', handleRateChange);
    if (mp3Button) mp3Button.addEventListener('click', toggleMP3);
}


function toggleMP3() {
    const mp3Player = document.getElementById('mp3Player');
    const mp3Button = document.getElementById('mp3Button');

    if (!mp3Player || !mp3Button) return;

    
    const pathParts = window.location.pathname.split('/');
    const newsId = pathParts[pathParts.length - 1].replace('.html', '');
    const mp3Path = `${newsId}.mp3`;

    const mp3Source = mp3Player.querySelector('source');
    if (!mp3Source?.src) mp3Source.src = mp3Path;

    mp3Player.style.display = 'block';

    if (mp3Player.paused) {
        mp3Player.load();
        mp3Player.addEventListener('loadeddata', function onLoad() {
            mp3Player.removeEventListener('loadeddata', onLoad);
            mp3Player.play()
                .then(() => {
                    isMP3Playing = true;
                    mp3Button.innerHTML = `<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"><rect x="6" y="4" width="4" height="16"></rect><rect x="14" y="4" width="4" height="16"></rect></svg><span>Tạm dừng</span>`;
                })
                .catch(error => { isMP3Playing = false; });
        });
    } else {
        mp3Player.pause();
        isMP3Playing = false;
        mp3Button.innerHTML = `<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"><path d="M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3z"/><path d="M19 10v2a7 7 0 0 1-14 0v-2"/>	</svg><span>Audio đã thu</span>`;
    }
}


function setupMP3EventListeners() {
    const mp3Player = document.getElementById('mp3Player');
    const mp3Button = document.getElementById('mp3Button');
    if (mp3Player && mp3Button) {
        mp3Player.addEventListener('ended', function() {
            isMP3Playing = false;
            mp3Button.innerHTML = `<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"><path d="M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3z"/><path d="M19 10v2a7 7 0 0 1-14 0v-2"/></svg><span>Audio đã thu</span>`;
        });
    }
}


function toggleSpeech() {
    if (isMP3Playing) {
        const mp3Player = document.getElementById('mp3Player');
        const mp3Button = document.getElementById('mp3Button');
        mp3Player.pause();
        isMP3Playing = false;
        if (mp3Button) mp3Button.innerHTML = `<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"><path d="M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3z"/><path d="M19 10v2a7 7 0 0 1-14 0v-2"/></svg><span>Audio đã thu</span>`;
    }

    if (!ttsInitialized) {
        showError('TTS chưa sẵn sàng');
        return;
    }

    if (!isPlaying) {
        startReading();
        isTTSPlaying = true;
    } else {
        stopReading();
        isTTSPlaying = false;
    }
}


function startReading() {
    isPlaying = true;
    currentParagraphIndex = 0;
    updateUI('reading');
    readNextParagraph();
}


function readNextParagraph() {
    if (currentParagraphIndex < paragraphs.length) {
        try {
            const voiceName = document.getElementById('voiceSelect').value;
            const rate = parseFloat(document.getElementById('rateSelect').value);
            const voiceConfig = TTS_CONFIG.VOICE_OPTIONS[voiceName];

            updateProgress(((currentParagraphIndex + 1) / paragraphs.length) * 100);
            highlightParagraph(currentParagraphIndex);

            responsiveVoice.speak(
                paragraphs[currentParagraphIndex].text,
                voiceName,
                {
                    pitch: voiceConfig.pitch,
                    rate: rate,
                    volume: voiceConfig.volume,
                    lang: voiceConfig.lang,
                    onstart: function() { updateStatus(`Đang đọc đoạn ${currentParagraphIndex + 1}/${paragraphs.length}`); },
                    onend: function() {
                        unhighlightParagraph(currentParagraphIndex);
                        currentParagraphIndex++;
                        if (isPlaying && currentParagraphIndex < paragraphs.length) {
                            setTimeout(readNextParagraph, TTS_CONFIG.PAUSE_BETWEEN);
                        } else if (currentParagraphIndex >= paragraphs.length) {
                            finishReading();
                        }
                    }
                }
            );
        } catch (error) {
            stopReading();
        }
    } else {
        finishReading();
    }
}

function stopReading() {
    responsiveVoice.cancel();
    isPlaying = false;
    isTTSPlaying = false;
    unhighlightAll();
    updateUI('paused');
}

function finishReading() {
    isPlaying = false;
    isTTSPlaying = false;
    updateProgress(100);
    updateUI('finished');
    unhighlightAll();
}

function highlightParagraph(index) {
    if (paragraphs[index]) {
        paragraphs[index].element.classList.add('current');
        scrollToParagraph(paragraphs[index].element);
    }
}

function unhighlightParagraph(index) {
    if (paragraphs[index]) paragraphs[index].element.classList.remove('current');
}

function unhighlightAll() {
    paragraphs.forEach(p => p.element.classList.remove('current'));
}

function scrollToParagraph(element) {
    element.scrollIntoView({ behavior: 'smooth', block: 'center' });
}

function updateUI(state) {
    const button = document.getElementById('playButton');
    if (button) {
        button.innerHTML = isPlaying ? 
            `<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"><rect x="6" y="4" width="4" height="16"></rect><rect x="14" y="4" width="4" height="16"></rect></svg><span>Tạm dừng</span>` :
            `<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"><polygon points="5 3 19 12 5 21 5 3"></polygon></svg><span>Đọc bài viết</span>`;
    }
    updateStatus(state);
}

function updateStatus(state) {
    const status = document.getElementById('status');
    const statusText = document.getElementById('statusText');
    if (status && statusText) {
        status.className = 'status active ' + state;
        statusText.textContent = typeof state === 'string' ? state : 
            state === 'reading' ? 'Đang đọc...' :
            state === 'paused' ? 'Đã tạm dừng' :
            state === 'finished' ? 'Đã đọc xong' : '';
    }
}

function updateProgress(percent) {
    const progress = document.getElementById('progress');
    if (progress) progress.style.width = percent + '%';
}

function handleVoiceChange() { if (isPlaying) restartReading(); }
function handleRateChange() { if (isPlaying) restartReading(); }
function restartReading() { stopReading(); startReading(); }

function showError(message) {
    const statusText = document.getElementById('statusText');
    const status = document.getElementById('status');
    if (statusText && status) {
        statusText.textContent = message;
        status.className = 'status active error';
    }
}

function updateParentHeight() {
    const height = document.documentElement.scrollHeight;
    window.parent.postMessage({ height: height }, '*');
}

function shareOnFacebook() {
    const url = window.location.href;
    window.open('https://www.facebook.com/sharer/sharer.php?u=' + encodeURIComponent(url));
}

function shareOnTwitter() {
    const url = window.location.href;
    const title = document.title;
    window.open('https://twitter.com/intent/tweet?url=' + encodeURIComponent(url) + '&text=' + encodeURIComponent(title));
}
</script>
</body>
</html>